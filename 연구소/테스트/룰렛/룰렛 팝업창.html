<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>룰렛 팝업창</title>
   <style>
        /* 팝업 전체 배경 */
.popup {
  display: none;
  position: fixed;
  z-index: 9999;
  left: 50%;
  top: 50%;
  transform: translate(-50%, -50%); /* 정중앙 배치 */
  background-color: rgba(0,0,0,0.6);
  width: 100%;
  height: 100%;
}

/* 팝업 내용 */
.popup-content {
  position: absolute;
  background-color: #fff;
  padding: 20px;
  border-radius: 10px;
  width: 400px;
  height: 500px;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  box-shadow: 0 5px 15px rgba(0,0,0,0.3);
}
/* 드래그 핸들 (제목 영역) */
.popup-header {
  font-weight: bold;
  padding-bottom: 10px;
  cursor: move;
  /* border: 1px solid red; */
}

/* 닫기 버튼 */
.close-btn {
  position: absolute;
  top: 0px;
  right: 5px;
  font-size: 24px;
  cursor: pointer;
}

/* 링크 스타일 */
.popup-link {
  display: inline-block;
  margin-top: 15px;
  padding: 10px 20px;
  background-color: #f15a24;
  color: #fff;
  text-decoration: none;
  border-radius: 5px;
}
.popup-link:hover {
  background-color: #d44b1c;
}

    </style>
  <style>
    .roulette-content {
      text-align: center;
      font-family: sans-serif;
      background: #f0f0f0;
      padding-top: 50px;
    }

    .wheel-container {
      position: relative;
      width: 300px;
      height: 300px;
      margin: 0 auto;
    }

    .wheel {
      width: 100%;
      height: 100%;
      border-radius: 50%;
      border: 10px solid #333;
      position: relative;
      transition: transform 3s ease-out;
      background: conic-gradient(
        #cce1ff 0deg 60deg,
        #7bb0ff 60deg 120deg,
        #cce1ff 120deg 180deg,
        #7bb0ff 180deg 240deg,
        #cce1ff 240deg 300deg,
        #7bb0ff 300deg 360deg
      );
    }

    .pointer {
      position: absolute;
      
      top: -20px;
      left: 50%;
      transform: translateX(-25%);
      width: 0;
      height: 0;
      border-left: 20px solid transparent;
      border-right: 20px solid transparent;
      border-top: 100px solid #ff4a4a;
    }

    #spinBtn {
      margin-top: 30px;
      padding: 10px 20px;
      font-size: 18px;
      cursor: pointer;
    }
    .roulette_title{
         font-size: 30px;
         font-weight: bold;
    }
    .roulette_title2{
         font-size: 18px;
         font-weight: bold;
         margin-bottom: 30px;
    }
    .segment {
        position: absolute;
        width: 50%;
        height: 50%;
        top: 50%;
        left: 50%;
        transform-origin: 0% 0%;
        transform: rotate(calc(var(--i) * 60deg + 30deg)) translateX(-27%); 
    }
    .segment img{
      position: absolute;
      top: 80px;
      width: 80px; height: 40px;
    }
#result {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -150%); /* 룰렛 위쪽에 표시되게 조정 */
  background-color: rgba(0, 0, 0, 0.8);
  color: #fff;
  padding: 10px 20px;
  border-radius: 12px;
  font-size: 18px;
  font-weight: bold;
  display: none; 
  z-index: 10;
  pointer-events: none;
  white-space: nowrap;
}
.confetti-container {
  position: absolute;
  top: -135px;
  left: -20px;
  width: 335px;
  height: 450px;
  pointer-events: none;
  overflow: hidden;
  z-index: 50;
  /* border: 5px solid red; */
}

.confetti {
  position: absolute;
  width: 100%;
  height: 100%;
  background-image: url("/룰렛이미지/종이가루5.png"); /* ✅ 꽃가루 이미지 */
  background-size: cover;
  /* background-color: yellow; */
  /* background-repeat: no-repeat;
  background-position: center;
  background-size: 100% 100%; */
  animation: popUpDown 3s ease-out forwards;
  opacity: 0;
}

@keyframes popUpDown {
  0% {
    transform: translateY(300px) scale(0.8) rotate(0deg);
    opacity: 0;
  }
  10% {
    opacity: 1;
  }
  40% {
    transform: translateY(-300px) scale(1.2) rotate(180deg);
  }

  100% {
    transform: translateY(500px) scale(0.7) rotate(180deg);
     opacity: 1; 
  }
}

  </style>
</head>
<body>
빈 페이지
    <!-- 팝업창 -->
<div id="eventPopup" class="popup">
  <div class="popup-content" id="popupContent">
    <div id="popupHeader" class="popup-header roulette_title">⭐신규가입자 한정⭐</div>
    <span class="close-btn" onclick="closePopup()">&times;</span>
    <div class="roulette_title2">특별 이벤트!!</div>
      <div class="wheel-container">
    <div class="wheel" id="wheel">
                    <!-- 경품 이미지 넣는곳 -->
    <div class="segment" style="--i: 0;"><img src="룰렛이미지/상품권낱개1.png" /></div>
    <div class="segment" style="--i: 1;"><img src="img2.png" /></div>
    <div class="segment" style="--i: 2;"><img src="룰렛이미지/상품권낱개1.png" /></div>
    <div class="segment" style="--i: 3;"><img src="img4.png" /></div>
    <div class="segment" style="--i: 4;"><img src="룰렛이미지/상품권낱개1.png" /></div>
    <div class="segment" style="--i: 5;"><img src="img6.png" /></div>
    </div>
    <div class="pointer"></div>
    <button id="spinBtn">돌리기!</button>
    <div id="result">🎉 당첨 결과</div>
    <!-- 꽃가루 효과를 담는 영역 -->
    <div class="confetti-container" id="confetti-container"></div>
   </div>
  </div>
    <!-- <a href="/event" class="popup-link">이벤트 바로가기</a> -->
  </div>
</div>

<!-- <div class="roulette-content">
  <div class="roulette_title">⭐신규가입자 한정⭐</div>
  <div class="roulette_title2">특별 이벤트!!</div>

  <div class="wheel-container">
    <div class="wheel" id="wheel"> -->
                    <!-- 경품 이미지 넣는곳 -->
    <!-- <div class="segment" style="--i: 0;"><img src="img1.png" /></div>
    <div class="segment" style="--i: 1;"><img src="img2.png" /></div>
    <div class="segment" style="--i: 2;"><img src="img3.png" /></div>
    <div class="segment" style="--i: 3;"><img src="img4.png" /></div>
    <div class="segment" style="--i: 4;"><img src="img5.png" /></div>
    <div class="segment" style="--i: 5;"><img src="img6.png" /></div>
    </div>
    <div class="pointer"></div>
    <button id="spinBtn">돌리기!</button>
    <div id="result">🎉 당첨 결과</div> -->
    <!-- 꽃가루 효과를 담는 영역 -->
    <!-- <div class="confetti-container" id="confetti-container"></div>
   </div>
  </div> -->

  
<script>
  // 팝업 드래그 함수
  dragElement(document.getElementById("popupContent"));

  function dragElement(elmnt) {
    let pos1 = 0, pos2 = 0, pos3 = 0, pos4 = 0;
    const header = document.getElementById("popupHeader");

    if (header) {
      header.onmousedown = dragMouseDown;
    } else {
      elmnt.onmousedown = dragMouseDown;
    }

    function dragMouseDown(e) {
      e = e || window.event;
      e.preventDefault();
      // 초기 커서 위치 저장
      pos3 = e.clientX;
      pos4 = e.clientY;
      document.onmouseup = closeDragElement;
      document.onmousemove = elementDrag;
    }

    function elementDrag(e) {
      e = e || window.event;
      e.preventDefault();
      // 커서가 이동한 거리 계산
      pos1 = pos3 - e.clientX;
      pos2 = pos4 - e.clientY;
      pos3 = e.clientX;
      pos4 = e.clientY;
      // 요소의 새 위치 설정
      elmnt.style.top = (elmnt.offsetTop - pos2) + "px";
      elmnt.style.left = (elmnt.offsetLeft - pos1) + "px";
    }

    function closeDragElement() {
      document.onmouseup = null;
      document.onmousemove = null;
    }
  }
  // 페이지가 로드되면 팝업 보이기
  window.onload = function() {
    // 쿠키 확인해서 이미 본 사용자는 생략 (선택 사항)
    // if (!getCookie("eventPopupClosed")) {
    //   document.getElementById("eventPopup").style.display = "block";
    // }
    document.getElementById("eventPopup").style.display = "block";//생략안하면 여기만 사용
  };

  function closePopup() {
    document.getElementById("eventPopup").style.display = "none";
    // 하루 동안 다시 안 뜨게 쿠키 저장 (선택 사항)
    setCookie("eventPopupClosed", true, 1);
  }

  // 쿠키 설정
  function setCookie(name, value, days) {
    let expires = "";
    if (days) {
      const date = new Date();
      date.setTime(date.getTime() + (days*24*60*60*1000));
      expires = "; expires=" + date.toUTCString();
    }
    document.cookie = name + "=" + (value || "")  + expires + "; path=/";
  }

  // 쿠키 가져오기
  function getCookie(name) {
    const nameEQ = name + "=";
    const ca = document.cookie.split(';');
    for(let i=0; i < ca.length; i++) {
      let c = ca[i];
      while (c.charAt(0)==' ') c = c.substring(1,c.length);
      if (c.indexOf(nameEQ) == 0) return c.substring(nameEQ.length,c.length);
    }
    return null;
  }
</script>
  <script>
    const wheel = document.getElementById('wheel');
    const button = document.getElementById('spinBtn');
    const resultDiv = document.getElementById("result");
    let deg = 0;
    const segments = 6; // 총 칸 수
    const prizes = ["상품A", "상품B", "상품C", "상품D", "상품E", "상품F"];

    button.addEventListener('click', () => {
        resultDiv.style.display = "none"; // 돌릴 때 결과 숨김
      // 선택각도 사이에서 무작위 회전
      const randomDeg = Math.floor(360 + Math.random() * 3600);
      deg += randomDeg;
      wheel.style.transform = `rotate(${deg}deg)`;

     // 룰렛이 끝날 때 결과 표시
     setTimeout(() => {
    const normalizedDeg = deg % 360; // 0~359 범위로 정리
    const sectorSize = 360 / segments;
    const pickedIndex = Math.floor((360 - normalizedDeg) / sectorSize) % segments;

   // ✅ 결과를 alert 대신 div에 표시
    resultDiv.textContent = `🎉 당첨: ${prizes[pickedIndex]}!`;
    resultDiv.style.display = "block";
    // ✅ confetti 실행
    launchConfetti(); // 아래에 정의된 함수
  }, 4000); // transition 시간과 동일하게 설정
    });


  function launchConfetti() {
  const container = document.querySelector('.confetti-container');

  for (let i = 0; i < 2; i++) {
    const confetti = document.createElement('div');
    confetti.classList.add('confetti');

    // 위치와 애니메이션 타이밍 랜덤
    confetti.style.left = (1-i) * 200-100 + 'px';
    // confetti.style.animationDelay = (Math.random() * 0.5) + 's';
    // confetti.style.transform = `rotate(${Math.random() * 360}deg)`;

    container.appendChild(confetti);

    // 애니메이션 후 제거
    setTimeout(() => {
      confetti.remove();
    }, 5000); // 애니메이션보다 약간 여유 있게
  }
}

  </script>
</body>
</html>
